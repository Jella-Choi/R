rm(list=ls())

height <- c(163,161,168,161,157,162,153,159,164,170,
            152,160,157,168,150,165,156,151,162,150,
            156,152,161,165,168,167,165,168,159,156)
height

# ì ì¶”ì •
n <- length(height);n
xbar <- mean(height);xbar  # í‘œë³¸í‰ê· 
s <- sd(height);s # í‘œì¤€í¸ì°¨
se <- s/sqrt(n);se # í‘œì¤€ì˜¤ì°¨

# êµ¬ê°„ì¶”ì •
# qnorm : normal ë¶„í¬ì˜ quantile -> z_alphaê°’ ì•Œìˆ˜ ìˆìŒ
qnorm(0.025) # qnorm(p): P(Z<x)=p 
qnorm(1-0.025)
qnorm(0.025,lower.tail=F) # : P(Z>x)=p

# 95% ì‹ ë¢°êµ¬ê°„
alpha <- 0.05
z_0.025 <- qnorm(1-alpha/2);z_0.025  # 
c(xbar-z_0.025*se,xbar+z_0.025*se) # 95% Confidence Interval

# 99% ì‹ ë¢°êµ¬ê°„
alpha <- 0.01
z_0.005 <- qnorm(1-alpha/2);z_0.005 
c(xbar-z_0.005*se,xbar+z_0.005*se) # 99% Confidence Interval

## í•´ì„: 99%ì˜ ì‹ ë¢°ë„ì¼ ê²½ìš°ì— ì‹ ë¢°êµ¬ê°„ì´ ë” ê¸¸ë‹¤


# ì‹ ë¢°êµ¬ê°„ì˜ ì˜ë¯¸
for (i in c(1,3,2,4,5)) {
  print(i)
}

rnorm(80,0,1) # ì •ê·œë¶„í¬ì—ì„œ 80ê°œì˜ í‘œë³¸ random ì¶”ì¶œ
rnorm(80) # rnorm(80,0,1)ë‘ ë˜‘ê°™ìŒ
set.seed(1) # ë‚œìˆ˜ê°’ ê³ ì •
rnorm(80)
set.seed(1)
rnorm(80)

seq(100) # 1:100 ë‘ ë˜‘ê°™ìŒ


xbar <- c();xbar
sd <- c();sd

for (i in 1:100) { # -> í‘œë³¸(í¬ê¸°:80)ì„ 100ë²ˆ ì¶”ì¶œ
  set.seed(i)
  temp <- rnorm(80) # ê°seed ë³„ë¡œ ë‚œìˆ˜ë¥¼ 80ê°œ ì¶”ì¶œ 
  xbar[i] <- mean(temp)
  sd[i] <- sd(temp)
}

xbar
sd

n <- 80;n
se <- sd/sqrt(n);se 
z_0.025 <- qnorm(0.025,lower.tail=F);z_0.025  # ì‹ ë¢°ë„ 95%
lower <- xbar-z_0.025*se;lower
upper <- xbar+z_0.025*se;upper

plot(xbar,cex=0.7,ylim=c(-1,1)) # í‘œë³¸ì˜ í‰ê· 
abline(h=0,col='red')

for (i in 1:100) { # ì‹ ë¢°êµ¬ê°„
  segments(i,lower[i],i,upper[i])
}

100-sum(lower>0|upper<0) # ì‹ ë¢°ë„ 95%ì¼ ê²½ìš°, í‰ê· ì„ í¬í•¨í•˜ëŠ” ì¶”ì •êµ¬ê°„ì˜ ê°œìˆ˜

## ëª¨í‰ê· ì— ëŒ€í•œ ê°€ì„¤ ê²€ì •
# ì˜ˆì œ. íŠ¹ì • ì²´ì¤‘ê°ëŸ‰ ë³´ì¡°ì œë¥¼ ë³µìš©í•˜ì˜€ì„ ë•Œ, 
# 5ì£¼ ë™ì•ˆ 10kgì´ìƒì„ ê°ëŸ‰í•  ìˆ˜ ìˆë‹¤ëŠ” í•´ë‹¹ ì—…ì²´ì˜ ì£¼ì¥ì´ ì˜³ë‹¤ê³  í•  ìˆ˜ ìˆëŠ”ì§€ ìœ ì˜ìˆ˜ì¤€ 5%ë¡œ ê²€ì •í•˜ë¼.
# ì°¸ê°€ìëŠ” 56ëª…ì´ë©° 5ì£¼ë™ì•ˆ ì²´ì¤‘ ê°ì†ŒëŸ‰ì˜ í‰ê· ì€ 10.5, í‘œì¤€í¸ì°¨ëŠ” 4.5ì˜€ë‹¤.
# H0: mu = 10 vs. H1: mu > 10
n <- 56;n
xbar <- 10.5;xbar  # í‘œë³¸ í‰ê· 
sd <- 4.5;sd   # í‘œë³¸ í‘œì¤€í¸ì°¨
se <- sd/sqrt(n);se # í‘œì¤€ ì˜¤ì°¨
mu_0 <- 10;mu_0

z_0.05 <- qnorm(0.05,lower.tail=F);z_0.05  # ë‹¨ì¸¡ ê²€ì •
Z <- (xbar-mu_0)/se;Z  # z í†µê³„ëŸ‰
Z > z_0.05 # ê¸°ê°X -> H0 ì±„íƒ
p_value <- pnorm(Z,lower.tail=F);p_value
# ì²´ì¤‘ê°ëŸ‰ ë³´ì¡°ì œë¥¼ ë³µìš©í•˜ì—¬ 10kg ì´ìƒì„ ê°ëŸ‰í•  ìˆ˜ ìˆë‹¤ê³  í•  ìˆ˜ ì—†ë‹¤.
p_value <- pnorm(Z);p_value
?pnorm

# ì˜ˆì œ. ì¶”ì • ì˜ˆì œì—ì„œ ì¤‘í•™êµ ë‚¨í•™ìƒ í‚¤ì˜ í‰ê· ì´ ë‹¤ë¥¸ ë„ì‹œ ì¤‘í•™êµ 1í•™ë…„ ë‚¨í•™ìƒ í‰ê·  í‚¤ 159ì™€ ì°¨ì´ê°€ ìˆëŠ”ì§€ ê²€ì •í•˜ë¼.
# ì•ì„œ êµ¬í•œ í‚¤ì˜ í‰ê· ì€ 160.2, í‘œì¤€í¸ì°¨ëŠ” 5.99ì˜€ìœ¼ë©° í•™ìƒ ìˆ˜ëŠ” 30ëª…ì´ì—ˆë‹¤.
# H0: mu = 159 vs. H1: mu != 159
n <- 30;n
xbar <- 160.2;xbar
sd <- 5.99;sd
se <- sd/sqrt(n);se
mu_0 <- 159;mu_0

Z <- (xbar-mu_0)/se;Z 
p_value <- 2*pnorm(abs(Z), lower.tail=F);p_value
# ìœ ì˜ìˆ˜ì¤€ì´ ì•Œë ¤ì ¸ ìˆì§€ ì•Šì§€ë§Œ, ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” 0.05,0.01,0.1ë³´ë‹¤ p-ê°’ì´ í¬ë¯€ë¡œ H0°ê°í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ì§€ ì•Šë‹¤. ì£¼ì–´
# ì§„ ë„ì‹œì˜ ì¤‘í•™êµ 1í•™ë…„ ë‚¨í•™ìƒ í‰ê· í‚¤ê°€ ë‹¤ë¥¸ ë„ì‹œì˜ í‰ê· ê³¼ ì°¨ì´ê°€ ìˆë‹¤ê³  íŒë‹¨í•  ìˆ˜ ì—†ë‹¤.